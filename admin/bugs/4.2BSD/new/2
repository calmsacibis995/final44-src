From sjk@sri-spam  Thu Dec 15 15:31:14 1983
Date: Thu, 15 Dec 83 14:31:14 pst
From: sjk@sri-spam (Scott J. Kramer)
Reply-To: sjk@sri-spam
Subject: MH "repl" headers can violate protocol
Index: new/mh/cmds/replsubs.c 4.2BSD Fix

Description:
	It is sometimes possible for the MH "repl" program to generate the
	reply addresses with spaces around the "@"s [eg, "sjk @ sri-spam"].
	This violates RFC822, if I understand it correctly, or at least
	causes "sendmail" to complain since it parses the header as three
	addresses rather than a single one.
Repeat-By:
	If a user mails to a "non-forwarding" local user and the message
	includes a "Reply-To" header containing a hostname, a bogus "Cc"
	header will be generated by the "repl" program.

	For example, if "sjk" mails a message to local user "sjkx" which
	contains "Reply-To: sjk@sri-spam", the "repl" program will create
	a "Cc: sjkx @ sri-spam" header, which is invalid.  I believe that
	the "To" header will be correct, however.

Fix:
    Change the "replsubs.c" module as follows:

    *** /tmp/,RCSt1003519	Thu Dec 15 13:33:57 1983
    --- replsubs.c	Thu Dec 15 00:53:58 1983
    ***************
    *** 147,153
		    case '@':
			    if(!textseen)
				    return(0);
    ! 			bufp = copy(" @ ", buf);
			    copyaddr(cp+1, bufp);
			    return(buf);
		    case ',':  case '\n':  case 0:

    --- 147,153 -----
		    case '@':
			    if(!textseen)
				    return(0);
    ! 			bufp = copy("@", buf);
			    copyaddr(cp+1, bufp);
			    return(buf);
		    case ',':  case '\n':  case 0:
