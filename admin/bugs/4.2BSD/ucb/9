Return-Path: <sam@ucbmonet>
Date: Sat, 22 Oct 83 13:11:20 pdt
From: sam@ucbmonet (Sam Leffler)
Subject: dbx barfs on enums w/o tags which are a member of a structure/union
Index: 	ucb/dbx/object.c 4.2BSD

Description:
	The symbol table info generated by the C compiler for
	enumerated types which are a member of a structure or union
	causes dbx to blow up;  changes are needed for both the
	compiler and dbx.
Repeat-By:
	Try cc -g enum.c on the following
	struct foo {
		enum { RED, GREEN, BLUE } b;
	};

	main()
	{
	}
	then invoke dbx, it will blow up with an "assertion failed"
	message.
Fix:
	Incorporate the following changes to lib/pcc/stab.c----

	2c2
	< static char *sccsid ="@(#)stab.c	1.9 (Berkeley) 8/11/83";
	---
	> static char *sccsid ="@(#)stab.c	1.10 (Berkeley) 10/22/83";
	465a466
	> 	putchar(';');

	and to ucb/dbx/object.c----

	3c3
	< static char sccsid[] = "@(#)object.c 1.13 8/16/83";
	---
	> static char sccsid[] = "@(#)object.c 1.14 10/22/83";
	942a943,944
	> 		if (*curchar == ';')
	> 			curchar++;

	(Note: I have already made the changes on monet and installed new
	copies of the compiler and dbx there.)
