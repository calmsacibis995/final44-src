h36321
s 00000/00000/00014
d D 8.1 93/06/04 18:25:47 bostic 47 46
c 4.4BSD snapshot (revision 8.1)
e
s 00001/00001/00013
d D 5.32 93/05/16 10:07:28 bostic 46 45
c move libg to contrib with gcc2
e
s 00001/00001/00013
d D 5.31 93/04/28 15:21:13 bostic 45 44
c mv libdbm to /usr/src/old/libndbm
e
s 00002/00002/00012
d D 5.30 92/07/15 11:44:10 bostic 44 43
c add libg++
e
s 00003/00003/00011
d D 5.29 92/07/15 09:30:00 bostic 43 42
c move csu directories down a level
e
s 00001/00001/00013
d D 5.28 92/06/23 10:46:28 bostic 42 41
c add libedit
e
s 00001/00001/00013
d D 5.27 92/04/08 08:26:36 bostic 41 40
c break kvm routines out of libutil
e
s 00001/00001/00013
d D 5.26 91/11/15 18:38:59 bostic 40 38
c add libtelnet
e
s 00003/00009/00005
d D 5.25.1.1 91/05/07 11:04:55 bostic 39 38
c branch for the 2nd network distribution
e
s 00008/00000/00006
d D 5.25 91/04/30 12:54:32 bostic 38 37
c add pcc versions for vax, tahoe, otherwise just do csu.${MACHINE}
e
s 00000/00006/00006
d D 5.24 91/01/13 10:12:13 bostic 37 36
c move Fortran libraries to f77 directory
e
s 00001/00001/00011
d D 5.23 91/01/11 16:23:20 bostic 36 35
c move pascal library into the pascal directory
e
s 00004/00004/00008
d D 5.22 90/12/28 17:45:35 bostic 35 34
c Fortran isn't available for 386
e
s 00001/00001/00011
d D 5.21 90/08/24 11:19:16 bostic 34 33
c go into librpc/rpc, SUN reorged it
e
s 00001/00003/00011
d D 5.20 90/07/03 18:57:08 bostic 33 32
c don't treat clean/cleandir specially
e
s 00010/00002/00004
d D 5.19 90/06/25 13:45:56 bostic 32 31
c checkpoint for June tape
e
s 00003/00033/00003
d D 5.18 90/05/11 12:53:29 bostic 31 30
c first pass for new make
e
s 00001/00001/00035
d D 5.17 89/08/25 14:27:59 kfall 30 29
c don't build Kerb. libraries here anymore
e
s 00001/00001/00035
d D 5.16 89/07/30 11:20:21 bostic 29 28
c lib2648 -> /usr/src/old
e
s 00001/00001/00035
d D 5.15 89/07/11 18:53:51 mckusick 28 27
c add sunrpc to the list
e
s 00022/00070/00014
d D 5.14 89/05/10 22:36:35 bostic 27 26
c file reorg, cleanup
e
s 00009/00004/00075
d D 5.13 88/06/13 10:41:05 bostic 26 25
c add Berkeley copyright notice; libom has been moved to ../old
e
s 00013/00017/00066
d D 5.12 87/07/27 17:10:05 bostic 25 24
c new template
e
s 00023/00029/00060
d D 5.11 87/06/21 16:39:46 bostic 24 23
c new template
e
s 00001/00001/00088
d D 5.10 86/06/07 10:18:07 mckusick 23 22
c add learn
e
s 00003/00001/00086
d D 5.9 85/10/11 17:52:29 mckusick 22 21
c depend on FRC not /tmp
e
s 00001/00001/00086
d D 5.8 85/09/07 16:07:27 mckusick 21 20
c strip on install
e
s 00009/00011/00078
d D 5.7 85/08/26 11:09:05 mckusick 20 19
c new `make depend'; rebuild dependencies
e
s 00001/00001/00088
d D 5.6 85/08/09 21:47:19 mckusick 19 18
c add liby
e
s 00001/00001/00088
d D 5.5 85/06/07 16:40:12 miriam 18 17
c Include libom in the subdirectory list.
e
s 00001/00001/00088
d D 5.4 85/06/06 09:55:40 dist 17 16
c Add copyright
e
s 00007/00007/00082
d D 5.3 85/06/05 20:04:58 mckusick 16 15
c cleanups; -for
e
s 00013/00001/00076
d D 5.2 85/05/30 23:20:20 sam 15 14
c add tags
e
s 00006/00001/00071
d D 5.1 85/04/30 12:27:41 dist 14 13
c Add copyright
e
s 00001/00001/00071
d D 4.12 85/04/29 18:59:58 eric 13 12
c add -me source directory
e
s 00001/00007/00071
d D 4.11 84/08/02 10:26:04 mckusick 12 10
c atrun moves to usr.bin/at subdirectory
e
s 00001/00001/00077
d R 4.11 83/11/10 14:57:06 ralph 11 10
c lib2648 moved to /usr/src/ucb/fed
e
s 00003/00003/00075
d D 4.10 83/07/09 23:37:07 sam 10 9
c let's get it right folks
e
s 00001/00001/00077
d D 4.9 83/07/09 23:34:01 sam 9 8
c someone forgot curses
e
s 00001/00001/00077
d D 4.8 83/07/02 18:36:31 sam 8 7
c include fix
e
s 00001/00001/00077
d D 4.7 83/06/10 23:08:21 sam 7 6
c no more libjobs
e
s 00003/00002/00075
d D 4.6 83/04/02 13:56:03 sam 6 5
c patch destination directory; add bc library
e
s 00002/00002/00075
d D 4.5 83/03/09 15:22:28 ralph 5 4
c removed vpr and added lib2648 subdirectories.
e
s 00007/00001/00070
d D 4.4 83/02/26 13:21:35 sam 4 3
c atrun moved from etc
e
s 00001/00001/00070
d D 4.3 82/12/03 19:54:42 mckusick 3 2
c add lpr
e
s 00002/00002/00069
d D 4.2 82/11/22 18:18:08 mckusick 2 1
c add libU77; libmp moves from lib to usr.lib
e
s 00071/00000/00000
d D 4.1 82/10/21 00:59:12 mckusick 1 0
c date and time created 82/10/21 00:59:12 by mckusick
e
u
U
f b 
t
T
I 1
D 10
#	%W%	(Berkeley)	%G%
E 10
I 10
D 14
#	%M%	%I%	%E%
E 14
I 14
D 31
#
D 17
# Copyright (c) 1980 Regents of the University of California.
E 17
I 17
D 24
# Copyright (c) 1983 Regents of the University of California.
E 24
I 24
D 27
# Copyright (c) 1987 Regents of the University of California.
E 27
I 27
# Copyright (c) 1989 The Regents of the University of California.
E 27
E 24
E 17
D 26
# All rights reserved.  The Berkeley software License Agreement
# specifies the terms and conditions for redistribution.
E 26
I 26
# All rights reserved.
E 26
#
I 26
# Redistribution and use in source and binary forms are permitted
D 27
# provided that this notice is preserved and that due credit is given
# to the University of California at Berkeley. The name of the University
# may not be used to endorse or promote products derived from this
# software without specific prior written permission. This software
# is provided ``as is'' without express or implied warranty.
E 27
I 27
# provided that the above copyright notice and this paragraph are
# duplicated in all such forms and that any documentation,
# advertising materials, and other materials related to such
# distribution and use acknowledge that the software was developed
# by the University of California, Berkeley.  The name of the
# University may not be used to endorse or promote products derived
# from this software without specific prior written permission.
# THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
E 27
#
E 31
E 26
#	%W% (Berkeley) %G%
E 14
E 10
D 31
#
E 31
D 26
DESTDIR=
E 26
D 27
CFLAGS=	-O
I 25
LIBC=	/lib/libc.a
E 25
I 15
TAGSFILE=tags
E 27
E 15

I 15
D 27
# Subdirectories whose routines are included in the making of the
# master tags file (/usr/lib/tags); the Fortran libraries should
# be on this list, but we don't control them....
#
TAGSDIR=libcurses libdbm libln libm libmp libpc libtermlib
E 27
I 27
D 29
SUBDIR=	des kdb krb lib2648 libF77 libI77 libU77 libc libcurses libdbm \
E 29
I 29
D 30
SUBDIR=	des kdb krb libF77 libI77 libU77 libc libcurses libdbm \
E 30
I 30
D 31
SUBDIR=	libF77 libI77 libU77 libc libcurses libdbm \
E 30
E 29
D 28
	libg libln libm libmp libpc libplot libtermlib libutil liby
E 28
I 28
	libg libln libm libmp libpc libplot libtermlib libutil liby sunrpc
E 31
I 31
D 32
SUBDIR=	csu libF77 libI77 libU77 libc libcurses libcompat libdbm libln \
	libm libmp libpc libplot librpc libterm libutil liby
E 32
I 32
D 35
SUBDIR=	libF77 libI77 libc libcurses libcompat libdbm libm libmp \
D 34
	libpc libplot libresolv librpc libterm libutil liby
E 34
I 34
	libpc libplot libresolv librpc/rpc libterm libutil liby
E 35
I 35
D 36
SUBDIR=	libc libcurses libcompat libdbm libm libmp libpc libplot \
E 36
I 36
D 39
D 41
SUBDIR=	libc libcurses libcompat libdbm libm libmp libplot \
E 41
I 41
D 42
SUBDIR=	libc libcurses libcompat libdbm libkvm libm libmp libplot \
E 42
I 42
D 44
SUBDIR=	libc libcurses libcompat libdbm libedit libkvm libm libmp libplot \
E 42
E 41
E 36
D 40
	libresolv librpc/rpc libterm libutil liby
E 40
I 40
	libresolv librpc/rpc libtelnet libterm libutil liby
E 44
I 44
D 45
SUBDIR=	libc libcurses libcompat libdbm libedit libg++ libkvm libm libmp \
E 45
I 45
D 46
SUBDIR=	libc libcurses libcompat libedit libg++ libkvm libm libmp \
E 46
I 46
SUBDIR=	libc libcurses libcompat libedit libkvm libm libmp \
E 46
E 45
	libplot libresolv librpc/rpc libtelnet libterm libutil liby
E 44
E 40
E 39
I 39
# Missing: libcompat libdbm libmp libplot
E 39
E 35
E 34

I 38
D 39
.if	${MACHINE} == "tahoe"
D 43
SUBDIR+=csu.tahoe.pcc
E 43
I 43
SUBDIR+=csu/tahoe.pcc
E 43
.elif	${MACHINE} == "vax"
D 43
SUBDIR+=csu.vax.pcc
E 43
I 43
SUBDIR+=csu/vax.pcc
E 43
.else
D 43
SUBDIR+=csu.${MACHINE}
E 43
I 43
SUBDIR+=csu/${MACHINE}
E 43
.endif
E 39
I 39
SUBDIR=	csu.${MACHINE} libc libcurses libm \
	libresolv librpc/rpc libterm libutil liby
E 39

E 38
D 33
.if   make(clean) || make(cleandir)
SUBDIR+=libU77
.elif ${MACHINE} == "tahoe"
E 33
I 33
D 37
.if ${MACHINE} == "tahoe"
E 33
D 35
SUBDIR+=csu libU77
E 35
I 35
SUBDIR+=csu libF77 libI77 libU77
E 35
.elif ${MACHINE} == "vax"
D 35
SUBDIR+=csu libU77
E 35
I 35
SUBDIR+=csu libF77 libI77 libU77
E 35
.endif
E 32
E 31
E 28
E 27

E 37
E 15
D 27
# Programs that live in subdirectories, and have makefiles of their own.
#
D 2
SUBDIR=	libF77 libI77 libdbm libg libjobs libln libm libnm libplot \
	libtermlib sendmail vpr
E 2
I 2
D 5
SUBDIR=	libF77 libI77 libU77 libdbm libg libjobs libln libm libmp \
D 3
	libnm libplot libtermlib sendmail vpr
E 3
I 3
	libnm libplot libtermlib lpr sendmail vpr
E 5
I 5
D 7
SUBDIR=	lib2648 libF77 libI77 libU77 libdbm libg libjobs libln libm libmp \
E 7
I 7
D 10
SUBDIR=	lib2648 libF77 libI77 libU77 libdbm libg libln libm libmp \
E 7
D 9
	libnm libplot libtermlib lpr sendmail
E 9
I 9
	libnm libplot libcurses libtermlib lpr sendmail
E 10
I 10
D 23
SUBDIR=	lib2648 libF77 libI77 libU77 libcurses libdbm libg libln \
E 23
I 23
SUBDIR=	learn lib2648 libF77 libI77 libU77 libcurses libdbm libg libln \
E 23
D 13
	libm libmp libnm libpc libplot libtermlib lpr sendmail
E 13
I 13
D 16
	libm libmp libnm libpc libplot libtermlib lpr me sendmail
E 16
I 16
D 18
	libm libmp libpc libplot libtermlib lpr me sendmail
E 18
I 18
D 19
	libom libm libmp libpc libplot libtermlib lpr me sendmail
E 19
I 19
D 26
	libom libm libmp libpc libplot libtermlib liby lpr me sendmail
E 26
I 26
	libm libmp libpc libplot libtermlib liby lpr me sendmail
E 27
I 27
D 31
all clean cleandir depend lint tags: FRC
	@-for i in ${SUBDIR}; do \
		(echo "==> $$i"; \
		    cd $$i; make ${MFLAGS} DESTDIR=${DESTDIR} $@); done
E 27
E 26
E 19
E 18
E 16
E 13
E 10
E 9
E 5
E 3
E 2

D 25
# Shell scripts that need only be installed and are never removed.
#
SCRIPT=	makewhatis

E 25
I 24
D 27
# C source that lives in the current directory
#
SRCS=	getNAME.c makekey.c
E 27
I 27
install: FRC
	@-for i in ${SUBDIR}; do \
		(echo "==> $$i"; \
		    cd $$i; make ${MFLAGS} DESTDIR=${DESTDIR} $@); done
E 27

E 24
D 27
# C programs that live in the current directory and do not need
# explicit make lines.
#
D 4
STD=	getNAME makekey
E 4
I 4
D 12
STD=	atrun getNAME makekey
E 12
I 12
STD=	getNAME makekey
E 12
E 4

# C programs that live in the current directory and need explicit make lines.
#
D 24
NSTD=	
E 24
I 24
NSTD=
E 24

D 25
all:	${SUBDIR} ${STD} ${NSTD}
E 25
I 25
all: ${SUBDIR} ${STD} ${NSTD}
E 25

E 27
D 22
${SUBDIR}: /tmp
E 22
I 22
${SUBDIR}: FRC
E 22
D 27
	cd $@; make ${MFLAGS}
E 27
I 27
	cd $@; make ${MFLAGS} DESTDIR=${DESTDIR}
E 27
I 22

D 25
FRC:
E 22

${STD}:
E 25
I 25
D 27
${STD}: ${LIBC}
E 25
D 24
	cc ${CFLAGS} -o $@ $@.c
E 24
I 24
	${CC} ${CFLAGS} -o $@ $@.c
E 24

D 25
install:
E 25
I 25
install: FRC
E 25
D 16
	for i in ${SUBDIR}; do \
E 16
I 16
	-for i in ${SUBDIR}; do \
E 16
D 24
		(cd $$i; make ${MFLAGS} DESTDIR=${DESTDIR} install); done
D 6
	for i in ${SCRIPT}; do (install -c $$i.sh ${DESTDIR}/etc/$$i); done
	for i in ${STD} ${NSTD}; do (install $$i ${DESTDIR}/etc/$$i); done
E 6
I 6
D 16
	for i in ${SCRIPT}; do (install -c $$i.sh ${DESTDIR}/usr/lib/$$i); done
	for i in ${STD} ${NSTD}; do (install $$i ${DESTDIR}/usr/lib/$$i); done
E 16
I 16
	-for i in ${SCRIPT}; do (install -c $$i.sh ${DESTDIR}/usr/lib/$$i); done
D 21
	-for i in ${STD} ${NSTD}; do (install $$i ${DESTDIR}/usr/lib/$$i); done
E 21
I 21
	-for i in ${STD} ${NSTD}; do (install -s $$i ${DESTDIR}/usr/lib/$$i); done
E 21
E 16
	install -c lib.b ${DESTDIR}/usr/lib/lib.b
E 24
I 24
		(cd $$i; make ${MFLAGS} DESTDIR=${DESTDIR} install); \
	done
D 25
	-for i in ${SCRIPT}; do \
		(install -c -o bin -g bin -m 755 $$i.sh ${DESTDIR}/usr/lib/$$i); \
	done
E 25
	-for i in ${STD} ${NSTD}; do \
		(install -s -o bin -g bin -m 755 $$i ${DESTDIR}/usr/lib/$$i); \
	done
	install -c -o bin -g bin -m 755 lib.b ${DESTDIR}/usr/lib/lib.b
E 24
E 6

I 15
D 25
tags:
E 25
I 25
tags: FRC
E 25
D 16
	for i in ${TAGSDIR}; do \
E 16
I 16
	-for i in ${TAGSDIR}; do \
E 16
		(cd $$i; make ${MFLAGS} TAGSFILE=../${TAGSFILE} tags); \
	done

E 15
D 25
clean:
E 25
I 25
clean: FRC
E 25
D 15
	rm -f a.out core *.s *.o
E 15
I 15
D 24
	rm -f a.out core *.s *.o tags
E 24
I 24
	rm -f a.out core *.s *.o tags ${STD} ${NSTD}
E 24
E 15
D 16
	for i in ${SUBDIR}; do (cd $$i; make ${MFLAGS} clean); done
E 16
I 16
D 25
	-for i in ${SUBDIR}; do (cd $$i; make ${MFLAGS} clean); done
E 25
I 25
	for i in ${SUBDIR}; do (cd $$i; make ${MFLAGS} clean); done
E 25
E 16
D 24
	rm -f ${STD} ${NSTD}
E 24

D 25
depend:
E 25
I 25
depend: ldepend
	for i in ${SUBDIR}; do (cd $$i; make ${MFLAGS} depend); done

ldepend: FRC
E 25
D 20
	cat </dev/null >x.c
D 16
	for i in ${STD} ${NSTD}; do \
E 16
I 16
	-for i in ${STD} ${NSTD}; do \
E 16
		(echo $$i: $$i.c >>makedep; \
		/bin/grep '^#[ 	]*include' x.c $$i.c | sed \
			-e '/\.\.\/h/d' \
			-e 's,<\(.*\)>,"/usr/include/\1",' \
			-e 's/:[^"]*"\([^"]*\)".*/: \1/' \
			-e 's/\.c//' >>makedep); done
E 20
I 20
D 24
	for i in ${STD} ${NSTD}; do \
	    cc -M ${INCPATH} $$i.c | sed 's/\.o//' | \
	    awk ' { if ($$1 != prev) \
		{ if (rec != "") print rec; rec = $$0; prev = $$1; } \
		else { if (length(rec $$2) > 78) { print rec; rec = $$0; } \
		else rec = rec " " $$2 } } \
		END { print rec } ' >> makedep; done
E 20
	echo '/^# DO NOT DELETE THIS LINE/+2,$$d' >eddep
	echo '$$r makedep' >>eddep
	echo 'w' >>eddep
	cp Makefile Makefile.bak
	ed - Makefile < eddep
D 20
	rm eddep makedep x.c
E 20
I 20
	rm eddep makedep
E 20
	echo '# DEPENDENCIES MUST END AT END OF FILE' >> Makefile
	echo '# IF YOU PUT STUFF HERE IT WILL GO AWAY' >> Makefile
	echo '# see make depend above' >> Makefile
E 24
I 24
	mkdep -p ${CFLAGS} ${SRCS}
D 25
	-for i in ${SUBDIR}; do (cd $$i; make ${MFLAGS} depend); done
E 25
I 25

E 27
FRC:
E 31
I 31
.include <bsd.subdir.mk>
E 31
E 25
E 24
D 27

# Files listed in ${NSTD} have explicit make lines given below.

D 24
# DO NOT DELETE THIS LINE -- make depend uses it
E 24
I 24
# DO NOT DELETE THIS LINE -- mkdep uses it.
# DO NOT PUT ANYTHING AFTER THIS LINE, IT WILL GO AWAY.
E 24

I 4
D 12
atrun: atrun.c
atrun: /usr/include/stdio.h
atrun: /usr/include/sys/param.h
atrun: /usr/include/sys/dir.h
D 8
atrun: /usr/include/time.h
E 8
I 8
atrun: /usr/include/sys/time.h
E 8
atrun: /usr/include/sys/stat.h
E 12
E 4
D 20
getNAME: getNAME.c
getNAME: /usr/include/stdio.h
E 20
I 20
getNAME: getNAME.c /usr/include/strings.h /usr/include/stdio.h
E 20
makekey: makekey.c
D 24
# DEPENDENCIES MUST END AT END OF FILE
# IF YOU PUT STUFF HERE IT WILL GO AWAY
# see make depend above
E 24
I 24

# IF YOU PUT ANYTHING HERE IT WILL GO AWAY
E 27
E 24
E 1
