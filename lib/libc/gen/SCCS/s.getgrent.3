h08413
s 00001/00001/00165
d D 8.2 94/04/19 07:08:07 bostic 14 13
c spell
e
s 00002/00002/00164
d D 8.1 93/06/04 12:02:28 bostic 13 12
c 4.4BSD snapshot (revision 8.1); add 1993 to copyright
e
s 00001/00001/00165
d D 6.9 93/04/14 14:46:00 bostic 12 11
c misspelled the name of the getgrnam function
e
s 00008/00010/00158
d D 6.8 91/04/20 10:12:32 cael 11 10
c text changes or conversion to -mdoc (version 3)
e
s 00141/00095/00027
d D 6.7 91/04/19 14:50:11 cael 10 9
c macro and text revision (-mdoc version 3)
e
s 00021/00028/00101
d D 6.6 91/04/01 13:49:31 bostic 9 8
c delete setgrfile, ANSI style declarations, minor cleanups
e
s 00001/00011/00128
d D 6.5 90/06/23 17:56:13 trent 8 7
c new copyright notice
e
s 00083/00043/00056
d D 6.4 89/03/06 19:40:55 bostic 7 6
c rewritten from getpwent.3; cleanup, add setgroupent()
e
s 00054/00061/00045
d D 6.3 88/09/17 12:49:49 bostic 6 5
c rework get{gr,pw,fs}ent to all be about the same;
c fix some obvious problems, document that set{gr,pw,fs}ent closes any
c open files
e
s 00010/00004/00096
d D 6.2 87/11/05 14:44:12 bostic 5 3
c add setgrfile
e
s 00009/00003/00097
d R 6.2 87/11/05 14:20:36 bostic 4 3
c add setgrfile
e
s 00001/00001/00099
d D 6.1 85/05/15 14:59:55 mckusick 3 2
c 4.3BSD beta release manual page
e
s 00001/00001/00099
d D 5.1 85/05/15 14:59:47 mckusick 2 1
c manual page distributed with 4.2BSD
e
s 00100/00000/00000
d D 4.1 85/05/15 14:59:41 mckusick 1 0
c manual page distributed with 4.1BSD
e
u
U
t
T
I 6
D 7
.\" Copyright (c) 1988 Regents of the University of California.
.\" All rights reserved.  The Berkeley software License Agreement
.\" specifies the terms and conditions for redistribution.
E 7
I 7
D 10
.\" Copyright (c) 1989 The Regents of the University of California.
.\" All rights reserved.
E 10
I 10
D 13
.\" Copyright (c) 1989, 1991 The Regents of the University of California.
.\"  All rights reserved.
E 13
I 13
.\" Copyright (c) 1989, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
E 13
E 10
E 7
.\"
I 7
D 8
.\" Redistribution and use in source and binary forms are permitted
.\" provided that the above copyright notice and this paragraph are
.\" duplicated in all such forms and that any documentation,
.\" advertising materials, and other materials related to such
.\" distribution and use acknowledge that the software was developed
.\" by the University of California, Berkeley.  The name of the
.\" University may not be used to endorse or promote products derived
.\" from this software without specific prior written permission.
.\" THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
.\" WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
E 8
I 8
.\" %sccs.include.redist.man%
E 8
.\"
E 7
E 6
I 1
D 10
.\"	%W% (Berkeley) %G%
E 10
I 10
.\"     %W% (Berkeley) %G%
E 10
.\"
D 2
.TH GETGRENT 3 
E 2
I 2
D 3
.TH GETGRENT 3  "19 January 1983"
E 3
I 3
D 10
.TH GETGRENT 3  "%Q%"
E 3
E 2
.AT 3
.SH NAME
D 5
getgrent, getgrgid, getgrnam, setgrent, endgrent \- get group file entry
E 5
I 5
D 7
getgrent, getgrgid, getgrnam, setgrent, endgrent setgrfile \- get group file entry
E 7
I 7
D 9
getgrent, getgrnam, getgrgid, setgroupent, setgrfile, setgrent,
E 9
I 9
getgrent, getgrnam, getgrgid, setgroupent, setgrent,
E 9
endgrent \- get group file entry
E 7
E 5
.SH SYNOPSIS
.nf
I 6
D 7
.B #include <sys/types.h>
E 7
E 6
D 9
.B #include <grp.h>
.PP
.B struct group *getgrent()
.PP
I 7
.B struct group *getgrnam(name)
.B char *name;
.PP
E 7
.B struct group *getgrgid(gid)
D 6
.B int gid;
E 6
I 6
.B gid_t gid;
E 6
.PP
D 7
.B struct group *getgrnam(name)
E 7
I 7
.B setgroupent(stayopen)
.B int stayopen;
.PP
.B void setgrfile(name)
E 7
.B char *name;
.PP
.B setgrent()
.PP
D 6
.B endgrent()
E 6
I 6
.B void endgrent()
E 9
I 9
.ft B
#include <grp.h>

struct group *getgrent(void);

struct group *getgrnam(char *name);

struct group *getgrgid(gid_t gid);

setgrent(void);
setgroupent(int stayopen);

void endgrent(void);
.ft R
E 9
E 6
I 5
D 7
.PP
D 6
.B setgrfile(name)
E 6
I 6
.B void setgrfile(name)
E 6
.B char *name;
E 7
E 5
.fi
.SH DESCRIPTION
.I Getgrent,
.I getgrgid
and
.I getgrnam
D 6
each return pointers
to an object
with the following structure
containing the broken-out
fields of a line in the group file.
E 6
I 6
D 7
each return pointers to an object with the following structure
containing the broken-out fields of a line in the group file,
as described in
.IR < grp.h > .
E 6
.RS
E 7
I 7
each return a pointer to a structure containing the broken-out fields
of a line in the group file.  This structure is defined by the include
E 10
I 10
.Dd %Q%
.Dt GETGRENT 3
.Os
.Sh NAME
.Nm getgrent ,
.Nm getgrnam ,
.Nm getgrgid ,
.Nm setgroupent ,
D 11
.Nm setgrfile ,
E 11
I 11
.\" .Nm setgrfile ,
E 11
.Nm setgrent ,
.Nm endgrent
.Nd group database operations
.Sh SYNOPSIS
.Fd #include <grp.h>
.Ft struct group *
.Fn getgrent void
.Ft struct group *
D 12
.Fn getgrname "const char *name"
E 12
I 12
.Fn getgrnam "const char *name"
E 12
.Ft struct group *
.Fn getgrgid "gid_t gid"
.Ft struct group *
.Fn setgroupent "int stayopen"
D 11
.Ft void
.Fn setgrfile "const char *name"
E 11
I 11
.\" .Ft void
.\" .Fn setgrfile "const char *name"
E 11
.Ft int
.Fn setgrent void
.Ft void
.Fn endgrent void
.Sh DESCRIPTION
These functions operate on the group database file
.Pa /etc/group
which is described
in
.Xr group 5 .
Each line of the database is defined by the structure
.Ar group
found in the include
E 10
file
D 10
.IR < grp.h >,
and contains the following fields:
E 7
.PP
I 7
.RS
E 7
.nf
E 10
I 10
.Aq Pa grp.h :
.Bd -literal -offset indent
E 10
D 6
.so /usr/include/grp.h
E 6
I 6
D 7
struct	group {
	char	*gr_name;
	char	*gr_passwd;
	gid_t	gr_gid;
	char	**gr_mem;
E 7
I 7
struct group {
D 10
	char		*gr_name;		/* group name */
	char		*gr_passwd;	/* group password */
E 10
I 10
	char	*gr_name;	/* group name */
	char	*gr_passwd;	/* group password */
E 10
	gid_t	gr_gid;		/* group id */
D 10
	char		**gr_mem;		/* group members */
E 10
I 10
	char	**gr_mem;	/* group members */
E 10
E 7
};
D 10
.ft R
.ad
E 6
.fi
.RE
.PP
D 6
The members of this structure are:
.TP \w'gr_passwd'u+2n
gr_name
The name of the group.
.br
.ns
.TP \w'gr_passwd'u+2n
gr_passwd
The encrypted password of the group.
.br
.ns
.TP \w'gr_passwd'u+2n
gr_gid
The numerical group-ID.
.br
.ns
.TP \w'gr_passwd'u+2n
gr_mem
Null-terminated vector
of pointers to the individual
member names.
E 6
I 6
D 7
The fields have meanings described in
.IR grp (5).
E 7
I 7
These fields are more completely described in
.IR group (5).
E 7
E 6
.PP
I 7
.I Getgrnam
E 10
I 10
.Ed
.Pp
The functions
.Fn getgrnam
E 10
and
D 10
.I getgrgid
search the group database for a matching group name or group id,
E 10
I 10
.Fn getgrgid
search the group database for the given group name pointed to by
.Ar name
or the group id pointed to by
.Ar gid ,
E 10
respectively, returning the first one encountered.  Identical group
names or group gids may result in undefined behavior.
D 10
.PP
.I Getgrent
E 10
I 10
.Pp
The
.Fn getgrent
function
E 10
sequentially reads the group database and is intended for programs
that wish to step through the complete list of groups.
D 10
.PP
E 10
I 10
.Pp
E 10
D 14
All three routines will open the group file for reading, if necesssary.
E 14
I 14
All three routines will open the group file for reading, if necessary.
E 14
D 10
.PP
E 7
D 6
.I Getgrent
simply reads the next
line while
.I getgrgid
E 6
I 6
D 9
.I Setgrfile
changes the default group file to
D 7
.IR name ,
thus allowing usage of alternate group files.
E 7
I 7
.IR file ,
thus allowing the use of alternate group files.
E 7
.PP
E 9
I 7
.I Setgroupent
E 10
I 10
.Pp
The
D 11
.Fn setgrfile
function
changes the default group file to
.Fa file ,
thus allowing the use of alternate group files.
.Pp
The
E 11
.Fn setgroupent
function
E 10
opens the file, or rewinds it if it is already open.  If
D 10
.I stayopen
E 10
I 10
.Fa stayopen
E 10
is non-zero, file descriptors are left open, significantly speeding
D 10
up subsequent calls.  This functionality is unnecessary for
.I getgrent
E 10
I 10
functions subsequent calls.  This functionality is unnecessary for
.Fn getgrent
E 10
as it doesn't close its file descriptors by default.  It should also
be noted that it is dangerous for long-running programs to use this
functionality as the group file may be updated.
D 10
.PP
E 7
.I Setgrent
E 10
I 10
.Pp
The
.Fn setgrent
function
E 10
D 7
opens the file (closing any previously opened file) or rewinds it
if it it already open.
E 7
I 7
is identical to
D 10
.I setgroupent
E 10
I 10
.Fn setgroupent
E 10
with an argument of zero.
E 7
D 10
.PP
.I Endgrent
E 10
I 10
.Pp
The
.Fn endgrent
function
E 10
closes any open files.
D 10
.PP
D 7
.I Getgrgid
E 6
and
.I getgrnam
D 6
search until a matching
E 6
I 6
search the entire file (opening it if necessary) for a matching
E 6
.I gid
or
D 6
.I name
is found
(or until EOF is encountered).
Each routine picks up
where the others leave off
so successive calls may be used
to search the entire file.
E 6
I 6
.IR name .
E 7
E 6
.PP
D 6
A call to
.I setgrent
has the effect of rewinding
the group file
to allow
repeated searches.
.I Endgrent
may be called to
close the group file
when processing is complete.
I 5
.PP
\fISetgrfile\fP changes the default group file to \fIname\fP thus allowing
alternate grioup files to be used.  Note that it does \fInot\fP close the
previous file.  If this is desired, \fIendgrent\fP should be called prior
to it.
E 6
I 6
D 7
For programs wishing to read the entire database,
.I getgrent
reads the next entry (opening the file if necessary).
E 7
E 6
E 5
.SH FILES
/etc/group
.SH "SEE ALSO"
D 7
getlogin(3), getpwent(3), group(5)
E 7
I 7
 getpwent(3), group(5)
E 7
.SH DIAGNOSTICS
D 6
A null pointer
(0) is returned on EOF or error.
E 6
I 6
The routines
.IR getgrent ,
D 7
.IR getgruid ,
and
E 7
.IR getgrnam ,
E 10
I 10
.Sh RETURN VALUES
The functions
.Fn getgrent ,
.Fn getgrnam ,
E 10
D 7
return a null pointer (0) on EOF or error.
.I Setgrent
returns 0 on failure, 1 on success.
E 7
I 7
and
D 10
.IR getgrgid ,
return a null pointer on EOF or error.
.I Setgroupent
E 10
I 10
.Fn getgrgid ,
return a pointer to the group entry if successful; if end-of-file
is reached or an error occurs a null pointer is returned.
The functions
.Fn setgroupent
E 10
and
D 10
.I setgrent
return 0 on failure, 1 on success.
E 7
.I Endgrent
D 9
and
.I setgrfile
have no return value.
E 9
I 9
has no return value.
E 9
E 6
.SH BUGS
D 5
All information
is contained in a static area
so it must be copied if it is
E 5
I 5
D 6
All information is contained in a static area so it must be copied if it is
E 5
to be saved.
E 6
I 6
D 7
All information is contained in a static area so it must be
copied if it is to be saved.
E 7
I 7
All information is contained in a static buffer which is overwritten
by each new call.  It must be copied elsewhere to be retained.
.PP
The routines
.IR getgrent ,
.IR endgrent ,
.IR setgroupent ,
E 10
I 10
.Fn setgrent
return the value 1 if successful, otherwise the value
0 is returned.
The functions
.Fn endgrent
E 10
and
D 10
.IR setgrent
E 10
I 10
.Fn setgrfile
have no return value.
.Sh FILES
.Bl -tag -width /etc/group -compact
.It Pa /etc/group
group database file
.El
.Sh SEE ALSO
.Fn getpwent 3 ,
.Fn group 5
.Sh HISTORY
The functions
.Fn endgrent ,
.Fn getgrent ,
.Fn getgrnam ,
.Fn getgrgid ,
and
.Fn setgrent
appeared in
.At v7 .
The functions
.Fn setgrfile
and
.Fn setgroupent
appeared in
.Bx 4.3 Reno .
I 11
.Sh COMPATIBILITY
The historic function
.Fn setgrfile ,
which allowed the specification of alternate password databases, has
been deprecated and is no longer available.
E 11
.Sh BUGS
The functions
.Fn getgrent ,
.Fn getgrnam ,
.Fn getgrgid ,
.Fn setgroupent
and
.Fn setgrent
leave their results in an internal static object and return
a pointer to that object. Subsequent calls to
the same function
will modify the same object.
.Pp
The functions
.Fn getgrent ,
.Fn endgrent ,
.Fn setgroupent ,
and
.Fn setgrent
E 10
are fairly useless in a networked environment and should be
avoided, if possible.
I 9
D 10
.SH COMPATIBILITY
The historic function
.IR setgrfile ,
which allowed the specification of alternate password databases, has
been deprecated and is no longer available.
E 10
E 9
E 7
E 6
E 1
