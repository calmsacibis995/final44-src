h46752
s 00002/00002/00138
d D 8.1 93/06/04 13:08:11 bostic 8 7
c 4.4BSD snapshot (revision 8.1); add 1993 to copyright
e
s 00001/00001/00139
d D 6.6 93/04/20 12:15:38 hibler 7 6
c "include <stdlib>" changed to "include <stdlib.h>"
e
s 00075/00065/00065
d D 6.5 91/04/19 14:31:00 cael 6 5
c macro and text revision (-mdoc version 3)
e
s 00001/00011/00129
d D 6.4 90/06/23 17:55:54 trent 5 4
c new copyright notice
e
s 00015/00003/00125
d D 6.3 89/07/20 13:56:07 bostic 4 3
c written by Earl Cohen; add Berkeley specific copyright
e
s 00012/00006/00116
d D 6.2 85/09/29 13:47:08 mckusick 3 2
c ul does not interpret \u correctly
e
s 00003/00002/00119
d D 6.1 85/05/15 16:27:39 mckusick 2 1
c 4.3BSD beta release manual page
e
s 00121/00000/00000
d D 5.1 85/05/15 16:27:31 mckusick 1 0
c manual page first distributed with 4.2BSD
e
u
U
t
T
I 1
D 4
.\" Copyright (c) 1983 Regents of the University of California.
.\" All rights reserved.  The Berkeley software License Agreement
.\" specifies the terms and conditions for redistribution.
E 4
I 4
D 6
.\" Copyright (c) 1983 The Regents of the University of California.
E 6
I 6
D 8
.\" Copyright (c) 1983, 1991 The Regents of the University of California.
E 6
.\" All rights reserved.
E 8
I 8
.\" Copyright (c) 1983, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
E 8
E 4
.\"
I 4
D 5
.\" Redistribution and use in source and binary forms are permitted
.\" provided that the above copyright notice and this paragraph are
.\" duplicated in all such forms and that any documentation,
.\" advertising materials, and other materials related to such
.\" distribution and use acknowledge that the software was developed
.\" by the University of California, Berkeley.  The name of the
.\" University may not be used to endorse or promote products derived
.\" from this software without specific prior written permission.
.\" THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
.\" WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
E 5
I 5
.\" %sccs.include.redist.man%
E 5
.\"
E 4
D 6
.\"	%W% (Berkeley) %G%
E 6
I 6
.\"     %W% (Berkeley) %G%
E 6
.\"
I 4
D 6
.UC 7
E 4
D 2
.TH RANDOM 3 "19 January 1983"
E 2
I 2
.TH RANDOM 3 "%Q%"
E 2
.UC 5
.SH NAME
random, srandom, initstate, setstate \- better random number generator; routines for changing generators
.SH SYNOPSIS
.nf
.B long  random()
.PP
.B srandom(seed)
.B int  seed;
.PP
.B char  *initstate(seed, state, n)
.B unsigned  seed;
.B char  *state;
.B int  n;
.PP
.B char  *setstate(state)
.B char  *state;
.fi
.SH DESCRIPTION
.PP
.I Random
E 6
I 6
.Dd %Q%
.Dt RANDOM 3
.Os BSD 4.2
.Sh NAME
.Nm random ,
.Nm srandom ,
.Nm initstate ,
.Nm setstate
.Nd better random number generator; routines for changing generators
.Sh SYNOPSIS
D 7
.Fd #include <stdlib>
E 7
I 7
.Fd #include <stdlib.h>
E 7
.Ft long 
.Fn random void
.Ft void
.Fn srandom "unsigned seed"
.Ft char *
.Fn initstate "unsigned seed" "char *state" "int n"
.Ft char *
.Fn setstate "char *state"
.Sh DESCRIPTION
The
.Fn random
function
E 6
uses a non-linear additive feedback random number generator employing a
default table of size 31 long integers to return successive pseudo-random
D 3
numbers in the range from 0 to 2\u\s731\s10\d\-1.  The period of this
random number generator is very large, approximately 16*(2\u\s731\s10\d\-1).
E 3
I 3
numbers in the range from 0 to
.if t 2\u\s731\s10\d\(mi1.
.if n (2**31)\(mi1.
The period of this random number generator is very large, approximately
.if t 16\(mu(2\u\s731\s10\d\(mi1).
.if n 16*((2**31)\(mi1).
E 3
D 6
.PP
.I Random/srandom
E 6
I 6
.Pp
The
.Fn random Ns / Fn srandom
E 6
have (almost) the same calling sequence and initialization properties as
D 6
.I rand/srand.
E 6
I 6
.Xr rand 3 Ns / Xr srand 3 .
E 6
The difference is that
D 6
.IR rand (3)
E 6
I 6
.Xr rand
E 6
D 3
produces a much less random sequence -- in fact, the low dozen bits
E 3
I 3
produces a much less random sequence \(em in fact, the low dozen bits
E 3
generated by rand go through a cyclic pattern.  All the bits generated by
D 6
.I random
D 3
are usable.  For example, \*(lqrandom()&01\*(rq will produce a random binary
E 3
I 3
are usable.  For example, ``random()&01'' will produce a random binary
E 6
I 6
.Fn random
are usable.  For example,
.Sq Li random()&01
will produce a random binary
E 6
E 3
value.
D 6
.PP
E 6
I 6
.Pp
E 6
Unlike
D 6
.IR srand ,
.I srandom
E 6
I 6
.Xr srand ,
.Fn srandom
E 6
does not return the old seed; the reason for this is that the amount of
state information used is much more than a single word.  (Two other
routines are provided to deal with restarting/changing random
number generators).  Like
D 6
.IR rand (3),
E 6
I 6
.Xr rand 3 ,
E 6
however,
D 6
.I random
E 6
I 6
.Fn random
E 6
will by default produce a sequence of numbers that can be duplicated
by calling
D 6
.I srandom
E 6
I 6
.Fn srandom
E 6
with 
D 6
.I 1
E 6
I 6
.Ql 1
E 6
as the seed.
D 6
.PP
E 6
I 6
.Pp
E 6
The
D 6
.I initstate
E 6
I 6
.Fn initstate
E 6
routine allows a state array, passed in as an argument, to be initialized
for future use.  The size of the state array (in bytes) is used by
D 6
.I initstate
to decide how sophisticated a random number generator it should use -- the
E 6
I 6
.Fn initstate
to decide how sophisticated a random number generator it should use \(em the
E 6
more state, the better the random numbers will be.
(Current "optimal" values for the amount of state information are
8, 32, 64, 128, and 256 bytes; other amounts will be rounded down to
D 6
the nearest known amount.  Using less than 8 bytes will cause an error).
E 6
I 6
the nearest known amount.  Using less than 8 bytes will cause an error.)
E 6
The seed for the initialization (which specifies a starting point for
the random number sequence, and provides for restarting at the same
point) is also an argument.
D 6
.I Initstate
E 6
I 6
The
.Fn initstate
function
E 6
returns a pointer to the previous state information array.
D 6
.PP
E 6
I 6
.Pp
E 6
Once a state has been initialized, the
D 6
.I setstate
E 6
I 6
.Fn setstate
E 6
routine provides for rapid switching between states.
D 2
.I Setstate returns a pointer to the previous state array; its
E 2
I 2
D 6
.I Setstate
E 6
I 6
The
.Fn setstate
function
E 6
returns a pointer to the previous state array; its
E 2
argument state array is used for further random number generation
until the next call to
D 6
.I initstate
E 6
I 6
.Fn initstate
E 6
or
D 6
.I setstate.
.PP
E 6
I 6
.Fn setstate .
.Pp
E 6
Once a state array has been initialized, it may be restarted at a
different point either by calling
D 6
.I initstate
E 6
I 6
.Fn initstate
E 6
(with the desired seed, the state array, and its size) or by calling
both
D 6
.I setstate
E 6
I 6
.Fn setstate
E 6
(with the state array) and
D 6
.I srandom
E 6
I 6
.Fn srandom
E 6
(with the desired seed).
The advantage of calling both
D 6
.I setstate
E 6
I 6
.Fn setstate
E 6
and
D 6
.I srandom
E 6
I 6
.Fn srandom
E 6
is that the size of the state array does not have to be remembered after
it is initialized.
D 6
.PP
E 6
I 6
.Pp
E 6
With 256 bytes of state information, the period of the random number
D 3
generator is greater than 2\u\s769\s10\d, which should be sufficient for
most purposes.
E 3
I 3
generator is greater than
.if t 2\u\s769\s10\d,
.if n 2**69
which should be sufficient for most purposes.
E 3
D 6
.SH AUTHOR
E 6
I 6
.Sh AUTHOR
E 6
Earl T. Cohen
D 6
.SH DIAGNOSTICS
.PP
E 6
I 6
.Sh DIAGNOSTICS
E 6
If
D 6
.I initstate
E 6
I 6
.Fn initstate
E 6
is called with less than 8 bytes of state information, or if
D 6
.I setstate
E 6
I 6
.Fn setstate
E 6
detects that the state information has been garbled, error
messages are printed on the standard error output.
D 6
.SH "SEE ALSO"
rand(3)
.SH BUGS
E 6
I 6
.Sh SEE ALSO
.Xr rand 3
.Sh HISTORY
These
functions appeared in 
.Bx 4.2 .
.Sh BUGS
E 6
About 2/3 the speed of
D 6
.IR rand (3C).
E 6
I 6
.Xr rand 3 .
E 6
E 1
