h53449
s 00001/00001/00059
d D 8.2 94/04/19 07:19:09 bostic 5 4
c spell
e
s 00002/00002/00058
d D 8.1 93/06/04 16:53:30 bostic 4 3
c 4.4BSD snapshot (revision 8.1); add 1993 to copyright
e
s 00004/00000/00056
d D 5.3 92/05/26 14:37:32 bostic 3 2
c add LBL credit line
e
s 00001/00001/00055
d D 5.2 92/05/18 19:30:25 torek 2 1
c fix description of op/arg (wrong word)
e
s 00056/00000/00000
d D 5.1 92/04/27 17:15:54 sklower 1 0
c date and time created 92/04/27 17:15:54 by sklower
e
u
U
t
T
I 1
D 4
.\" Copyright (c) 1992 The Regents of the University of California.
.\" All rights reserved.
E 4
I 4
.\" Copyright (c) 1992, 1993
.\"	The Regents of the University of California.  All rights reserved.
E 4
.\"
I 3
.\" This code is derived from software developed by the Computer Systems
.\" Engineering group at Lawrence Berkeley Laboratory under DARPA contract
.\" BG 91-66 and contributed to Berkeley.
.\"
E 3
.\" %sccs.include.redist.man%
.\"
.\"     %W% (Berkeley) %G%
.\"
.Dd %Q%
.Dt KVM_GETFILES 3
.Os
.Sh NAME
.Nm kvm_getfiles
.Nd survey open files
.Sh SYNOPSIS
.Fd #include <kvm.h>
.Fd #include <sys/kinfo.h>
.Fd #define KERNEL
.Fd #include <sys/file.h>
.Fd #undef KERNEL
.\" .Fa kvm_t *kd
.br
.Ft char *
.Fn kvm_getfiles "kvm_t *kd" "int op" "int arg" "int *cnt"
.Sh DESCRIPTION
.Fn kvm_getfiles
returns a (sub-)set of the open files in the kernel indicated by
.Fa kd.
The
.Fa op
and
.Fa arg
D 2
arguments constitute a predicate which limits the set of processes
E 2
I 2
arguments constitute a predicate which limits the set of files
E 2
returned.  No predicates are currently defined.
.Pp
The number of processes found is returned in the reference parameter
.Fa cnt .
The files are returned as a contiguous array of file structures,
D 5
preceeded by the address of the first file entry in the kernel.
E 5
I 5
preceded by the address of the first file entry in the kernel.
E 5
This memory is owned by kvm and is not guaranteed to be persistent across
subsequent kvm library calls.  Data should be copied out if it needs to be
saved.
.Sh RETURN VALUES
.Fn kvm_getfiles
will return NULL on failure.
.Pp
.Sh BUGS
This routine does not belong in the kvm interface.
.Sh SEE ALSO
.Xr kvm 3 ,
.Xr kvm_open 3 ,
.Xr kvm_openfiles 3 ,
.Xr kvm_close 3 ,
.Xr kvm_read 3 ,
.Xr kvm_write 3 ,
.Xr kvm_nlist 3 ,
.Xr kvm_geterr 3
E 1
