h45955
s 00004/00002/00066
d D 5.29 91/11/15 10:53:14 bostic 44 43
c need dbx target
e
s 00010/00001/00058
d D 5.28 91/11/14 09:19:14 bostic 43 42
c make it compile again
e
s 00006/00001/00053
d D 5.27 91/11/13 09:08:08 bostic 42 41
c make it compile again
e
s 00007/00003/00047
d D 5.26 91/04/30 18:28:22 bostic 41 40
c move dbx.5 here from man/man5
e
s 00001/00000/00049
d D 5.25 91/04/30 18:21:56 bostic 40 39
c add dbx.5 to man pages
e
s 00002/00000/00047
d D 5.24 91/03/16 10:23:04 bostic 39 38
c re_comp, re_exec in libcompat now
e
s 00003/00000/00044
d D 5.23 91/01/21 10:14:20 bostic 38 37
c remove old li nk
e
s 00001/00001/00043
d D 5.22 91/01/17 15:12:18 bostic 37 36
c kernel reorg
e
s 00001/00001/00043
d D 5.21 91/01/17 13:07:17 bostic 36 35
c forgot sccs id
e
s 00032/00242/00012
d D 5.20 91/01/17 13:04:14 bostic 35 34
c pmake style makefile
e
s 00001/00001/00253
d D 5.19 91/01/15 18:16:52 bostic 34 33
c kernel reorg
e
s 00001/00001/00253
d D 5.18 90/06/29 20:38:32 trent 33 32
c one more try (nroff -mandoc, *sigh*)
e
s 00004/00001/00250
d D 5.17 90/06/29 20:36:47 trent 32 31
c add nroff for dbx.0
e
s 00015/00006/00236
d D 5.16 89/07/21 10:41:00 bostic 31 30
c add Berkeley specific copyright notice
e
s 00002/00002/00240
d D 5.15 89/05/10 22:20:46 bostic 30 29
c file reorg, pathnames.h, paths.h
e
s 00001/00001/00241
d D 5.14 89/03/06 11:56:21 bostic 29 28
c add all label
e
s 00006/00002/00236
d D 5.13 88/10/25 17:04:11 bostic 28 27
c add manual page
e
s 00001/00001/00237
d D 5.12 88/06/10 17:33:24 bostic 27 26
c owner bin, not root
e
s 00026/00019/00212
d D 5.11 88/01/11 23:34:56 donn 26 25
c merge in latest Linton version
e
s 00001/00000/00230
d D 5.10 88/01/07 13:44:44 bostic 25 24
c clean test directory
e
s 00001/00001/00229
d D 5.9 87/12/01 20:21:06 bostic 24 22
c date.o is a binary file
e
s 00001/00001/00229
d R 5.9 87/06/16 18:15:15 bostic 23 22
c fixed install
e
s 00002/00000/00228
d D 5.8 87/05/31 21:08:22 bostic 22 21
c added depend label
e
s 00000/00001/00228
d D 5.7 87/05/24 14:40:47 bostic 21 20
c MACHINE defined in Makefile
e
s 00001/00002/00228
d D 5.6 86/10/14 21:45:58 mckusick 20 18
c must specify machine
e
s 00001/00002/00228
d R 5.6 86/10/14 21:27:27 mckusick 19 18
c must specify machine
e
s 00001/00001/00229
d D 5.5 86/02/23 20:33:14 sam 18 17
c runtime is also machine-dependent
e
s 00024/00005/00206
d D 5.4 86/02/23 16:21:58 sam 17 15
c parameterize files for machine independence
e
s 00019/00004/00207
d R 5.4 86/02/22 22:24:29 sam 16 15
c update sccsid
e
s 00002/00001/00209
d D 5.3 85/10/09 10:23:51 bloom 15 14
c add DESTDIR for installation
e
s 00008/00005/00202
d D 5.2 85/06/18 18:32:42 bloom 14 13
c Change Maintainer and use optimizer
e
s 00006/00001/00201
d D 5.1 85/05/31 09:51:54 dist 13 12
c Add copyright
e
s 00141/00036/00061
d D 4.11 85/03/01 20:18:10 linton 12 11
c update to version 3.0
e
s 00036/00133/00061
d D 4.10 84/08/17 21:25:15 sam 11 10
c cleanup some linton'isms
e
s 00003/00001/00191
d D 4.9 84/06/23 11:39:14 sam 10 8
i 9
c merge linton branch delta trail
e
s 00022/00015/00167
d D 4.7.1.1 84/06/23 10:44:20 sam 9 7
c branch delta of linton changes from net.sources
e
s 00003/00000/00182
d D 4.8 84/06/23 10:39:29 sam 8 7
c add re pattern search of source code
e
s 00001/00001/00181
d D 4.7 84/01/03 16:14:01 sam 7 6
c leave -g on for debugging, installed version should be stripped anyway
e
s 00041/00001/00141
d D 4.6 83/07/15 14:46:42 linton 6 5
c fixed "clean" so that extraneous files are now removed 
c that were not done so previously, also added "tape" for generating 
c a tar tape of the dbx source
e
s 00003/00000/00139
d D 4.5 83/05/18 18:17:51 csvaf 5 4
c Added fortran and debugger source files
e
s 00001/00001/00138
d D 4.4 83/05/17 23:04:10 linton 4 3
c now installs with symbol table (helpful for debugging dbx)
e
s 00010/00003/00129
d D 4.3 83/03/31 00:21:02 linton 3 2
c changed way "date.c" is created
e
s 00004/00004/00128
d D 4.2 83/02/21 10:57:49 linton 2 1
c changed DEST and DESTDIR interaction so installed in /usr/ucb/dbx rather than //usr/ucb/dbx
e
s 00132/00000/00000
d D 4.1 83/02/11 13:03:57 sam 1 0
c date and time created 83/02/11 13:03:57 by sam
e
u
U
f b 
t
T
I 10
D 13
#	%M%	%I%	%E%
E 13
I 13
D 35
#
D 31
# Copyright (c) 1983 Regents of the University of California.
# All rights reserved.  The Berkeley software License Agreement
# specifies the terms and conditions for redistribution.
E 31
I 31
# Copyright (c) 1983 The Regents of the University of California.
# All rights reserved.
E 31
#
I 31
# Redistribution and use in source and binary forms are permitted
# provided that the above copyright notice and this paragraph are
# duplicated in all such forms and that any documentation,
# advertising materials, and other materials related to such
# distribution and use acknowledge that the software was developed
# by the University of California, Berkeley.  The name of the
# University may not be used to endorse or promote products derived
# from this software without specific prior written permission.
# THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
#
E 31
#	%W% (Berkeley) %G%
E 13
E 10
I 1
D 9
#	%W% (Berkeley) %G%
E 9
#
D 31
# make file for debugger "dbx"
#
E 31
I 31

E 35
E 31
D 36
# The file "defs.h" is included by all.
E 36
I 36
#	%W% (Berkeley) %G%
E 36
D 31
#
E 31
I 11
D 12
AOUT=	tdbx
DESTDIR=
DEST=	${DESTDIR}/usr/ucb/dbx
LIBS=	
CFLAGS=	-O
YFLAGS=	-d
LDFLAGS=
HDR=	asm.h events.h c.h check.h coredump.h eval.h fortran.h keywords.h \
	languages.h lists.h machine.h main.h mappings.h modula-2.h names.h \
	object.h operators.h pascal.h printsym.h process.h re.h \
	runtime.h scanner.h source.h stabstring.h symbols.h tree.h ops.h
SRCS=	asm.c events.c c.c cerror.s check.c coredump.c debug.c eval.c \
	fortran.c keywords.c languages.c library.c lists.c machine.c main.c \
	mappings.c modula-2.c names.c object.c operators.c pascal.c printsym.c \
	process.c re.c runtime.c scanner.c source.c symbols.c tree.c ops.c
OBJS=	y.tab.o asm.o events.o c.o cerror.o check.o coredump.o \
	debug.o eval.o fortran.o keywords.o languages.o library.o \
	lists.o machine.o main.o mappings.o modula-2.o names.o \
	object.o operators.o pascal.o printsym.o process.o re.o \
	runtime.o scanner.o source.o stabstring.o symbols.o tree.o \
	ops.o
E 12
E 11
D 9
# N.B.:
#    My version of cerror automatically catches certain errors
# such as out of memory, I/O error.  If you re-make this with
# the standard cerror, the program could fault unexpectedly.
#
E 9

D 35
.SUFFIXES:
D 28
.SUFFIXES: .h .c .s .o
E 28
I 28
.SUFFIXES: .h .c .s .o .1 .0
E 35
I 35
PROG=	dbx
D 37
CFLAGS+=-I. -I${.CURDIR} -I/sys
E 37
I 37
CFLAGS+=-I. -I${.CURDIR}
I 40
D 41
MAN5=	dbx.0
E 41
E 40
E 37
HDRS=	asm.h events.h c.h check.h coredump.h debug.h eval.h fortran.h \
	keywords.h languages.h lists.h machine.h main.h mappings.h \
	modula-2.h names.h object.h operators.h pascal.h printsym.h \
	process.h runtime.h scanner.h source.h stabstring.h symbols.h \
	tree.h ops.h
SRCS=	asm.c events.c c.c check.c coredump.c debug.c eval.c fortran.c \
	keywords.c languages.c library.c lists.c main.c mappings.c \
	modula-2.c names.c object.c operators.c pascal.c printsym.c \
	process.c scanner.c source.c stabstring.c symbols.c tree.c \
	${MACHINE}.c runtime.${MACHINE}.c ops.${MACHINE}.c
OBJS+=	cerror.${MACHINE}.o commands.o date.o
I 41

E 41
I 39
LDADD=	-lcompat
DPADD=	${LIBCOMPAT}
E 39
D 41
CLEANFILES+=mkdate makedefs makedefs.o date.c y.tab.h \
E 41
I 41
CLEANFILES+=mkdate makedefs makedefs.o date.c y.tab.h dbx.5.0 \
E 41
D 43
	${HDRS} ${MACHINE}.h runtime.${MACHINE}.h ops.${MACHINE}.h
E 43
I 43
	${HDRS} ${MACHINE}.h runtime.${MACHINE}.h ops.${MACHINE}.h \
	instrs.adb instrs.h
E 43
E 35
E 28

I 44
all: dbx

dbx: ${HDRS} dbx.5.0

E 44
I 17
D 20
#MACHINE	= vax
MACHINE	= tahoe
E 20
I 20
D 21
MACHINE	= unknown
E 21
E 20
E 17
I 12
D 35
AOUT	= tdbx
I 15
DESTDIR	=
E 15
D 30
DEST	= /usr/ucb/dbx
E 30
I 30
DEST	= /usr/bin/dbx
E 35
I 35
.c.h:
	./makedefs -f ${.CURDIR}/$*.c $*.h
E 35
E 30
D 44

I 14
D 26
# Install the mail address of the person maintaining dbx below
# as -DMAINTAINER.  A null string disables gripes.

E 26
E 14
D 35
CC	= cc
D 14
CFLAGS	= '-DMAINTAINER="linton@shasta"' -g
E 14
I 14
D 26
CFLAGS	= '-DMAINTAINER=""' -O
E 26
I 26
AS	= as
#
# if you want gripes
# CFLAGS = -g '-DMAINTAINER="linton@shasta.stanford.edu"'
#
D 34
CFLAGS	= -O # -g
E 34
I 34
CFLAGS	= -I/sys -O # -g
E 35
I 35
D 41
all: ${HDRS}
E 41
I 41
all: ${HDRS} dbx.5.0
E 44
E 41
E 35
E 34
E 26
E 14

D 35
LD = cc
D 14
LDFLAGS	= -g
E 14
I 14
D 26
LDFLAGS	= 
E 14
LIBRARIES =
E 26
I 26
LDFLAGS	= # -g
LIBRARIES = # -lPW for IRIS (System V)
E 35
I 35
machine.h: ${MACHINE}.h
I 38
	rm -f machine.h
E 38
	ln -s ${MACHINE}.h machine.h
E 35
E 26

D 26
# LD	= /bin/oldld
# LDFLAGS	= -X /lib/crt0.o
# LIBRARIES = -lg -lc

E 26
D 35
OBJ = \
    y.tab.o \
    asm.o \
    events.o \
    c.o \
    cerror.o \
    check.o \
    coredump.o \
    debug.o \
    eval.o \
    fortran.o \
    keywords.o \
    languages.o \
    library.o \
    lists.o \
    machine.o \
    main.o \
    mappings.o \
    modula-2.o \
    names.o \
    object.o \
    operators.o \
    pascal.o \
    printsym.o \
    process.o \
    runtime.o \
    scanner.o \
    source.o \
    stabstring.o \
    symbols.o \
    tree.o \
    ops.o
E 35
I 35
runtime.h: runtime.${MACHINE}.h
I 38
	rm -f runtime.h
E 38
	ln -s runtime.${MACHINE}.h runtime.h
E 35

D 35
HDR = \
    asm.h \
    events.h \
    c.h \
    check.h \
    coredump.h \
    debug.h \
    eval.h \
    fortran.h \
    keywords.h \
    languages.h \
    lists.h \
    machine.h \
    main.h \
    mappings.h \
    modula-2.h \
    names.h \
    object.h \
    operators.h \
    pascal.h \
    printsym.h \
    process.h \
    runtime.h \
    scanner.h \
    source.h \
    stabstring.h \
    symbols.h \
    tree.h \
    ops.h
E 35
I 35
ops.h: ops.${MACHINE}.h
I 38
	rm -f ops.h
E 38
	ln -s ops.${MACHINE}.h ops.h
E 35

D 35
SRC = \
    defs.h \
    commands.y \
    asm.c \
    events.c \
    c.c \
D 17
    cerror.s \
E 17
I 17
    cerror.${MACHINE}.s \
E 17
    check.c \
    coredump.c \
    debug.c \
    eval.c \
    fortran.c \
    keywords.c \
    languages.c \
    library.c \
    lists.c \
D 17
    machine.c \
E 17
    main.c \
    mappings.c \
    modula-2.c \
    names.c \
    object.c \
    operators.c \
    pascal.c \
    printsym.c \
    process.c \
D 17
    runtime.c \
E 17
    scanner.c \
    source.c \
    stabstring.c \
    symbols.c \
    tree.c \
D 17
    ops.c
E 17
I 17
    ${MACHINE}.c \
    runtime.${MACHINE}.c \
    ops.${MACHINE}.c
E 35
I 35
date.c: mkdate
	./mkdate > date.c
E 35
E 17

I 43
.if	${MACHINE} == "tahoe"
instrs.adb:
	ln -s /usr/src/bin/adb/adb.tahoe/instrs.adb ${.TARGET}
.elif	${MACHINE} == "vax"
E 43
E 12
D 11
AOUT	= tdbx
D 2
DEST	= /usr/ucb/dbx
DESTDIR	=
E 2
I 2
D 9
DESTDIR =
DEST	= ${DESTDIR}/usr/ucb/dbx
E 9
I 9
D 10
DEST	= /usr/local/bin/dbx
E 10
I 10
DESTDIR=
DEST	= ${DESTDIR}/usr/ucb/dbx
E 10
E 9
E 2

LIBRARIES =

CC	= cc
D 7
CFLAGS	= # -g
E 7
I 7
CFLAGS	= -g
E 7
D 2
LDFLAGS	= # -g
E 2
I 2
LDFLAGS	= -g
E 2

OBJ = \
    y.tab.o \
    asm.o \
    events.o \
    c.o \
    cerror.o \
    check.o \
    coredump.o \
I 5
    debug.o \
E 5
    eval.o \
I 5
    fortran.o \
E 5
    keywords.o \
    languages.o \
    library.o \
    lists.o \
    machine.o \
    main.o \
    mappings.o \
I 9
    modula-2.o \
E 9
    names.o \
    object.o \
    operators.o \
    pascal.o \
    printsym.o \
    process.o \
I 8
    re.o \
E 8
    runtime.o \
    scanner.o \
    source.o \
I 9
    stabstring.o \
E 9
    symbols.o \
    tree.o \
    ops.o

HDR = \
    asm.h \
    events.h \
    c.h \
    check.h \
    coredump.h \
    eval.h \
I 5
    fortran.h \
E 5
    keywords.h \
    languages.h \
    lists.h \
    machine.h \
    main.h \
    mappings.h \
I 9
    modula-2.h \
E 9
    names.h \
    object.h \
    operators.h \
    pascal.h \
    printsym.h \
    process.h \
I 8
    re.h \
E 8
    runtime.h \
D 9
    source.h \
E 9
    scanner.h \
I 9
    source.h \
    stabstring.h \
E 9
    symbols.h \
    tree.h \
    ops.h

I 6
SRC = \
    defs.h \
    commands.y \
    asm.c \
    events.c \
    c.c \
    cerror.s \
    check.c \
    coredump.c \
    debug.c \
    eval.c \
    fortran.c \
    keywords.c \
    languages.c \
    library.c \
    lists.c \
    machine.c \
    main.c \
    mappings.c \
I 9
    modula-2.c \
E 9
    names.c \
    object.c \
    operators.c \
    pascal.c \
    printsym.c \
    process.c \
I 8
    re.c \
E 8
    runtime.c \
    scanner.c \
    source.c \
    symbols.c \
    tree.c \
    ops.c

E 11
E 6
D 35
.c.o:
D 11
	@echo "compiling $*.c"
	@${CC} ${CFLAGS} -c $*.c
E 11
I 11
D 12
	${CC} ${CFLAGS} -c $*.c
E 12
I 12
	@echo "compiling $*.c"
	@${CC} ${CFLAGS} -c $*.c
E 35
I 35
D 42
${HDRS}: makedefs
E 42
I 42
INSTR=	${.CURDIR}/../as.vax/instrs
instrs.adb: ${INSTR}
	(echo FLAVOR ADB; cat ${INSTR}) | awk -f ${INSTR} > ${.TARGET}
I 43

instrs.h:
	ln -s ${.CURDIR}/../as.vax/instrs.h ${.TARGET}
.endif
E 43

.depend: ${HDRS} commands.o
${HDRS}: instrs.adb makedefs
E 42
makedefs: makedefs.c library.o cerror.${MACHINE}.o
	${CC} ${CFLAGS} \
	    ${.CURDIR}/makedefs.c library.o cerror.${MACHINE}.o -o $@
E 35
E 12
E 11

D 35
.s.o:
D 11
	@echo "assembling $*.s"
	@${CC}  -c $*.s
E 11
I 11
D 12
	${CC} -c $*.s
E 12
I 12
	@echo "assembling $*.s"
D 26
	@${CC}  -c $*.s
E 26
I 26
	@rm -f tmp
D 30
	@/lib/cpp $*.s | grep -v "^#" > tmp
E 30
I 30
	@cpp $*.s | egrep -v "^#" > tmp
E 30
	@${AS} -o $*.o tmp
	@rm -f tmp
E 26
E 12
E 11

.c.h:
D 11
	./makedefs -f $*.c $*.h
E 11
I 11
D 12
	@./makedefs -f $*.c $*.h
E 12
I 12
	./makedefs -f $*.c $*.h
E 12
E 11

D 3
${AOUT}: makedefs ${HDR} ${OBJ}
E 3
I 3
D 11
${AOUT}: makedefs mkdate ${HDR} ${OBJ}
E 11
I 11
D 12
${AOUT}: makedefs mkdate ${HDR} ${OBJS}
E 12
I 12
D 29
${AOUT}: makedefs mkdate ${HDR} ${OBJ}
E 29
I 29
all ${AOUT}: makedefs mkdate ${HDR} ${OBJ}
E 29
E 12
E 11
	@rm -f date.c
	@./mkdate > date.c
E 3
	@echo "linking"
D 3
	@${CC} ${LDFLAGS} ${OBJ} ${LIBRARIES} -o ${AOUT}
E 3
I 3
D 11
	@${CC} ${LDFLAGS} date.c ${OBJ} ${LIBRARIES} -o ${AOUT}
E 11
I 11
D 12
	@${CC} ${LDFLAGS} date.c ${OBJS} ${LIBS} -o ${AOUT}
E 12
I 12
	@${CC} ${CFLAGS} -c date.c
	@${LD} ${LDFLAGS} date.o ${OBJ} ${LIBRARIES} -o ${AOUT}
E 12
E 11
E 3

D 11
profile: ${HDR} ${OBJ}
E 11
I 11
D 12
profile: ${HDR} ${OBJS}
E 12
I 12
profile: ${HDR} ${OBJ}
E 12
E 11
I 3
	@rm -f date.c
	@./mkdate > date.c
E 3
	@echo "linking with -p"
D 3
	@${CC} ${LDFLAGS} -p ${OBJ} ${LIBRARIES} -o ${AOUT}
E 3
I 3
D 11
	@${CC} ${LDFLAGS} -p date.c ${OBJ} ${LIBRARIES} -o ${AOUT}
E 11
I 11
D 12
	@${CC} ${LDFLAGS} -p date.c ${OBJS} ${LIBS} -o ${AOUT}
E 12
I 12
	@${CC} ${LDFLAGS} -p date.c ${OBJ} ${LIBRARIES} -o ${AOUT}
E 12
E 11
E 3

y.tab.c: commands.y
I 9
	@echo "expect 2 shift/reduce conflicts"
E 9
D 11
	yacc -d commands.y
E 11
I 11
D 12
	${YACC} ${YFLAGS} commands.y
E 12
I 12
	yacc -d commands.y
E 12
E 11

I 17
cerror.s: cerror.${MACHINE}.s
	@rm -f cerror.s
	@ln -s cerror.${MACHINE}.s cerror.s

machine.c: ${MACHINE}.c
	@rm -f machine.c
	@ln -s ${MACHINE}.c machine.c

ops.c:	ops.${MACHINE}.c
	@rm -f ops.c
	@ln -s ops.${MACHINE}.c ops.c

runtime.c: runtime.${MACHINE}.c
	@rm -f runtime.c
	@ln -s runtime.${MACHINE}.c runtime.c

E 17
makedefs: makedefs.c library.o cerror.o
D 9
	${CC} makedefs.c library.o cerror.o -o makedefs
E 9
I 9
D 11
	${CC} -g makedefs.c library.o cerror.o -o makedefs
E 11
I 11
D 12
	${CC} ${CFLAGS} ${LDFLAGS} makedefs.c library.o cerror.o -o makedefs
E 12
I 12
D 14
	${CC} -g makedefs.c library.o cerror.o -o makedefs
E 14
I 14
D 26
	${CC} -O makedefs.c library.o cerror.o -o makedefs
E 26
I 26
	${CC} -g makedefs.c library.o cerror.o -o makedefs
E 26
E 14
E 12
E 11
E 9
I 3

E 35
mkdate: mkdate.c
D 9
	${CC} mkdate.c -o mkdate
E 9
I 9
D 11
	${CC} -g mkdate.c -o mkdate
E 11
I 11
D 12
	${CC} ${CFLAGS} ${LDFLAGS} mkdate.c -o mkdate
E 12
I 12
D 14
	${CC} -g mkdate.c -o mkdate
E 14
I 14
D 26
	${CC} -O mkdate.c -o mkdate
E 26
I 26
D 35
	${CC} -g ${CFLAGS} mkdate.c -o mkdate
E 35
I 35
	${CC} ${CFLAGS} ${.CURDIR}/mkdate.c -o $@
I 41

beforeinstall:
	install -c -o ${MANOWN} -g ${MANGRP} -m ${MANMODE} dbx.5.0 \
            ${DESTDIR}${MANDIR}5/dbx.0
E 41
E 35
E 26
E 14
E 12
E 11
E 9
E 3

I 32
D 35
dbx.0:	dbx.1
D 33
	nroff -man dbx.1 > dbx.0
E 33
I 33
	nroff -mandoc dbx.1 > dbx.0
E 33

E 32
print:
	@echo "don't print it, it's too long"

I 22
depend:

E 22
#
# Don't worry about the removal of header files, they're created from
# the source files.
#
I 12

E 12
D 11

E 11
clean:
D 6
	rm -f ${HDR} ${OBJ} y.tab.c y.tab.h ${AOUT} core
E 6
I 6
D 9
	rm -f ${HDR} ${OBJ} y.tab.c y.tab.h \
	    ${AOUT} mkdate mkdate.o makedefs makedefs.o date.c core
E 9
I 9
D 11
	rm -f ${HDR} ${OBJ} y.tab.c y.tab.h ${AOUT} \
	    mkdate mkdate.o makedefs makedefs.o date.c core mon.out prof.out
E 11
I 11
D 12
	rm -f ${HDR} ${OBJS} y.tab.c y.tab.h ${AOUT} \
	    mkdate mkdate.o makedefs makedefs.o date.c core mon.out \
	    prof.out errs
E 12
I 12
	rm -f ${HDR} ${OBJ} y.tab.c y.tab.h ${AOUT} mkdate mkdate.o \
D 17
	    makedefs makedefs.o date.c core mon.out prof.out make.out
E 17
I 17
	    makedefs makedefs.o date.c core mon.out prof.out make.out \
D 18
	    cerror.s ops.c machine.c
E 18
I 18
D 24
	    cerror.s ops.c machine.c runtime.c
E 24
I 24
	    cerror.s ops.c machine.c runtime.c date.o
I 25
	@chdir tests; make clean
E 25
E 24
E 18
E 17
E 12
E 11
E 9
E 6

I 28
cleandir: clean
	rm -f dbx.0 tags .depend

E 28
I 12
cleandefs:
	rm -f ${HDR} y.tab.h

E 12
D 9
install:
E 9
I 9
testinstall: ${AOUT} test install

test:
D 26
	@chdir tests; make
E 26
I 26
	@cd tests; make
E 26

D 28
install: ${AOUT}
E 28
I 28
install: ${AOUT} dbx.0
E 28
E 9
D 2
	install -s ${AOUT} ${DESTDIR}/${DEST}
E 2
I 2
D 4
	install -s ${AOUT} ${DEST}
E 4
I 4
D 14
	install ${AOUT} ${DEST}
E 14
I 14
D 15
	install -s ${AOUT} ${DEST}
E 15
I 15
D 26
	install -s ${AOUT} ${DESTDIR}/${DEST}
E 26
I 26
D 27
	install -s ${AOUT} ${DESTDIR}${DEST}
E 27
I 27
	install -s -o bin -g bin -m 755 ${AOUT} ${DESTDIR}${DEST}
I 28
D 32
	install -c -o bin -g bin -m 444 dbx.0 ${DESTDIR}/usr/man/cat1
E 32
I 32
	install -c -o bin -g bin -m 444 dbx.0 ${DESTDIR}/usr/share/man/cat1
E 32
E 28
E 27
E 26
E 15
E 14
I 6

D 11
#
# Create a tar file called "tape" containing relevant files.
#
E 11
I 11
D 12
tags:	defs.h ${SRCS}
	ctags -w defs.h ${SRCS}
E 12
I 12
#
# Create a tar file called "tape" containing relevant files.
#
E 12
E 11

I 12
D 26
TAPE = tape
E 26
I 26
TAPE = f tape
E 26

tape:
D 26
	@tar cf ${TAPE} \
	    Makefile History version READ_ME ${SRC} \
	    makedefs.c mkdate.c tests pchanges ptests
E 26
I 26
	@tar c${TAPE} Makefile History READ_ME ${SRC} \
	    makedefs.c mkdate.c tests pc0mods dbx.1 newdbx.1 dbxstab.5

#
# without tests subdirectory
#
srconlytape:
	@tar c${TAPE} Makefile History READ_ME ${SRC} \
	    makedefs.c mkdate.c dbx.1 newdbx.1 dbxstab.5
E 26

E 12
I 9
D 11
TAPE = tape

E 9
tape:
D 9
	tar cfv tape Makefile READ_ME TO_DO ${SRC} makedefs.c mkdate.c
E 9
I 9
	tar cfv ${TAPE} \
	    Makefile ${SRC} makedefs.c mkdate.c tests/ pchanges ptests
E 9
E 6
E 4
E 2

E 11
#
# Header dependencies are purposely incomplete since header files
# are "written" every time the accompanying source file changes even if
# the resulting contents of the header don't change.  The alternative is
# to force a "makedefs" to be invoked for every header file each time dbx
# is made.
#
# Also, there should be a dependency of scanner.o and keywords.o on y.tab.h
# but misfortunately silly make does a "makedefs y.tab.c y.tab.h" which
# destroys y.tab.h.
#
I 12

E 12
D 11

E 11
symbols.o tree.o check.o eval.o events.o: operators.h
E 35
I 35
.include <bsd.prog.mk>
E 35
E 1
