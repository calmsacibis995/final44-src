h60304
s 00001/00000/00206
d D 5.11 94/06/01 20:33:39 ah 13 12
c page breaks for 4.4BSD manuals
e
s 00001/00001/00205
d D 5.10 94/04/19 08:23:48 bostic 12 11
c spell
e
s 00001/00001/00205
d D 5.9 94/04/19 08:22:48 bostic 11 10
c spell
e
s 00001/00001/00205
d D 5.8 93/12/11 23:44:35 mckusick 10 9
c copyediting for Usenix manuals
e
s 00005/00006/00201
d D 5.7 93/06/09 19:23:06 bostic 9 6
c fix the under development line
c 4.4BSD snapshot (revision 8.1); add 1993 to copyright
e
s 00002/00002/00205
d R 8.1 93/06/09 19:21:59 bostic 8 7
c 4.4BSD snapshot (revision 8.1); add 1993 to copyright
e
s 00000/00000/00207
d R 5.7 93/06/09 19:21:55 bostic 7 6
c fixed the under development line
e
s 00005/00013/00202
d D 5.6 92/02/09 08:47:54 pendry 6 5
c merge in new release
e
s 00015/00007/00200
d D 5.5 91/08/05 06:46:29 cael 5 4
c fix history
e
s 00004/00000/00203
d D 5.4 91/05/12 15:56:02 pendry 4 3
c checkpoint for network tape
e
s 00015/00031/00188
d D 5.3 91/03/17 13:33:45 pendry 3 2
c from amd5.3 alpha11
e
s 00150/00143/00069
d D 5.2 91/03/16 18:11:27 cael 2 1
c macro and text revision (-mdoc version 3)
e
s 00212/00000/00000
d D 5.1 90/06/29 12:01:23 mckusick 1 0
c from Jan Pendry
e
u
U
t
T
I 6
.\"
E 6
I 4
D 5
.\"
E 5
E 4
I 1
D 2
.\" $Id: amd.8,v 5.2 90/06/23 22:21:12 jsp Rel $
E 2
.\" Copyright (c) 1989 Jan-Simon Pendry
.\" Copyright (c) 1989 Imperial College of Science, Technology & Medicine
D 2
.\" Copyright (c) 1989 The Regents of the University of California.
E 2
I 2
D 9
.\" Copyright (c) 1989, 1991 The Regents of the University of California.
E 2
.\" All rights reserved.
E 9
I 9
.\" Copyright (c) 1989, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
E 9
.\"
.\" This code is derived from software contributed to Berkeley by
.\" Jan-Simon Pendry at Imperial College, London.
.\"
D 2
.\"  %sccs.include.redist.man%
E 2
I 2
D 5
.\" %sccs.include.redist.man%
E 5
I 5
D 6
.\" %sccs.include.redist.roff%
E 6
I 6
.\" %sccs.include.redist.man%
E 6
E 5
E 2
.\"
D 2
.\"	%W% (Berkeley) %G%
E 2
I 2
D 5
.\"     %W% (Berkeley) %G%
E 5
I 5
D 6
.\"	%W% (Berkeley) %G%
E 6
I 6
.\"     %W% (Berkeley) %G%
E 6
E 5
E 2
.\"
I 4
D 6
.\" $Id: amd.8,v 5.2.1.2 91/05/07 22:20:43 jsp Alpha $
E 6
I 6
.\" $Id: amd.8,v 5.2.2.1 1992/02/09 15:11:39 jsp beta $
E 6
.\"
E 4
D 2
.TH AMD 8 "%Q%"
.SH NAME
amd \- automatically mount file systems
.SH SYNOPSIS
.B amd
[
.B \-nprv
] [
.BI \-a " mount_point"
] [
.BI \-c " duration"
] [
.BI \-d " domain"
] [
.BI \-k " kernel-arch"
] [
.BI \-l " logfile"
] [
.BI \-t " interval.interval"
] [
.BI \-w " interval"
] [
.BI \-x " log-option"
] [
.BI \-y " YP-domain"
] [
.BI \-C " cluster-name"
] [
.BI \-D " option"
]
[
.I directory
.I mapname
.RI [ " \-map-options " ]
] .\|.\|.
.SH DESCRIPTION
.B Amd
E 2
I 2
D 3
.Dd %Q%
E 3
I 3
D 9
.Dd March 17, 1991
E 9
I 9
.Dd "%Q%"
E 9
E 3
.Dt AMD 8
.Os
.Sh NAME
.Nm amd
.Nd automatically mount file systems
.Sh SYNOPSIS
.Nm amd
.Op Fl nprv
.Op Fl a Ar mount_point
.Op Fl c Ar duration
.Op Fl d Ar domain
.Bk -words
.Op Fl k Ar kernel-arch
.Ek
I 5
D 6
.Bk -words
E 6
E 5
.Op Fl l Ar logfile
I 5
D 6
.Ek
E 6
E 5
.Op Fl t Ar interval.interval
.Bk -words
.Op Fl w Ar interval
.Ek
.Op Fl x Ar log-option
I 5
D 6
.Bk -words
E 6
E 5
.Op Fl y Ar YP-domain
I 5
D 6
.Ek
E 6
E 5
.Bk -words
.Op Fl C Ar cluster-name
.Ek
.Op Fl D Ar option
I 5
D 6
.Bk -words
E 6
E 5
.Oo
.Ar directory mapname
.Op Fl map-options
.Oc
.Ar ...
I 5
D 6
.Ek
E 6
E 5
.Sh DESCRIPTION
.Nm Amd
E 2
is a daemon that automatically mounts filesystems
whenever a file or directory
within that filesystem is accessed.
Filesystems are automatically unmounted when they
D 2
appear to have become quiescent.
.LP
.B Amd
E 2
I 2
appear to be quiescent.
.Pp
.Nm Amd
E 2
D 3
has been designed as a value-added replacement
for the SunOS 4
D 2
.IR automount (8)
E 2
I 2
.Xr automount 8
E 2
program.
Considerable design effort has been expended in making
D 2
.B amd
E 2
I 2
.Nm amd
E 2
robust in the face of
D 2
.SM NFS
E 2
I 2
.Tn NFS
E 2
servers going down.
D 2
.B Amd
E 2
I 2
.Nm Amd
E 3
E 2
operates by attaching itself as an
D 2
.SM NFS
E 2
I 2
.Tn NFS
E 2
server to each of the specified
D 2
.IB directories .
E 2
I 2
.Ar directories .
E 2
Lookups within the specified directories
are handled by
D 2
.BR amd ,
E 2
I 2
.Nm amd ,
E 2
D 3
which uses the map contained in
E 3
I 3
which uses the map defined by
E 3
D 2
.I mapname
E 2
I 2
.Ar mapname
E 2
to determine how to resolve the lookup.
Generally, this will be a host name, some filesystem information
and some mount options for the given filesystem.
D 2
.SH OPTIONS
.TP
.B \-n
Normalize hostnames.
The name refered to by ${rhost} are normalized relative to the
host database before being used.  The effect is to translate
aliases into ``official'' names.
.TP
.B \-p
Print PID.
Outputs the process-id of
.B amd
to standard output where it can be saved into a file.
.TP
.B \-r
Restart existing mounts.
.B Amd
will scan the mount file table to determine which filesystems
are currently mounted.  Whenever one of these would have
been auto-mounted,
.B amd
.I inherits
it.
.TP
.B \-v
Version.  Displays version and configuration information on standard error.
If you send a bug report, this should be used to determine
which version of
.B amd
you are using.
.TP
.BI \-a " temporary-directory"
E 2
I 2
.Sh OPTIONS
.Bl -tag -width Ds
.It Fl a Ar temporary-directory
E 2
Specify an alternative location for the real mount points.
The default is
D 2
.BR /a .
.TP
.BI \-c " duration"
E 2
I 2
.Pa /a .
.It Fl c Ar duration
E 2
Specify a
D 2
.IR duration ,
E 2
I 2
.Ar duration ,
E 2
in seconds, that a looked up name remains
cached when not in use.  The default is 5 minutes.
D 2
.TP
.BI \-d " domain"
E 2
I 2
.It Fl d Ar domain
E 2
Specify the local domain name.  If this option is not
given the domain name is determined from the hostname.
D 2
.TP
.BI \-k " kernel-arch"
E 2
I 2
.It Fl k Ar kernel-arch
E 2
Specifies the kernel architecture.  This is used solely
to set the ${karch} selector.
D 2
.TP
.BI \-l " logfile"
E 2
I 2
.It Fl l Ar logfile
E 2
Specify a logfile in which to record mount and unmount events.
If
D 2
.I logfile
E 2
I 2
.Ar logfile
E 2
is the string
D 2
.B syslog
then the log messages will be sent to the system log daemon by
.IR syslog (3).
E 2
I 2
.Em syslog ,
the log messages will be sent to the system log daemon by
.Xr syslog 3 .
E 2
D 3
This is only available on certain systems (e.g.
D 2
.I not
.SM HP-UX
E 2
I 2
.Em not
.Tn HP-UX
E 2
and early versions of Ultrix).
E 3
D 2
.TP
.BI \-t " interval.interval"
E 2
I 2
.It Fl n
Normalize hostnames.
D 3
The name refered to by ${rhost} are normalized relative to the
E 3
I 3
D 11
The name refered to by ${rhost} is normalized relative to the
E 11
I 11
The name referred to by ${rhost} is normalized relative to the
E 11
E 3
host database before being used.  The effect is to translate
aliases into ``official'' names.
.It Fl p
Print
.Em PID .
Outputs the process-id of
.Nm amd
to standard output where it can be saved into a file.
.It Fl r
Restart existing mounts.
.Nm Amd
will scan the mount file table to determine which filesystems
are currently mounted.  Whenever one of these would have
been auto-mounted,
.Nm amd
.Em inherits
it.
.It Fl t Ar interval.interval
E 2
Specify the
D 2
.IR interval ,
in tenths of a second, between NFS/RPC/UDP retries.
E 2
I 2
.Ar interval ,
in tenths of a second, between
.Tn NFS/RPC/UDP
retries.
E 2
The default is 0.8 seconds.
D 12
The second values alters the restransmit counter.
E 12
I 12
The second values alters the retransmit counter.
E 12
Useful defaults are supplied if either or both
values are missing.
D 2
.TP
.BI \-w " interval"
E 2
I 2
.It Fl v
Version.  Displays version and configuration information on standard error.
I 13
.ne 1i
E 13
D 3
If you send a bug report, this should be used to determine
which version of
.Nm amd
you are using.
E 3
.It Fl w Ar interval
E 2
Specify an
D 2
.IR interval ,
E 2
I 2
.Ar interval ,
E 2
in seconds, between attempts to dismount
filesystems that have exceeded their cached times.
The default is 2 minutes.
D 2
.TP
.BI \-y " domain"
Specify an alternative YP domain from which to fetch the YP maps.
E 2
I 2
.It Fl y Ar domain
Specify an alternative
D 3
.Tn YP
E 3
I 3
.Tn NIS
E 3
domain from which to fetch the
D 3
.Tn YP
E 3
I 3
.Tn NIS
E 3
maps.
E 2
The default is the system domain name.
I 3
This option is ignored if
.Tn NIS
support is not available.
E 3
D 2
.TP
.BI \-x " options"
E 2
I 2
.It Fl x Ar options
E 2
Specify run-time logging options.  The options are a comma separated
D 3
list chosen from: fatal, error, user, warn, info, all.
E 3
I 3
list chosen from: fatal, error, user, warn, info, map, stats, all.
E 3
D 2
.TP
.BI \-D " option"
E 2
I 2
.It Fl D Ar option
E 2
Select from a variety of debug options.  Prefixing an
D 10
option with the strings
E 10
I 10
option with the string
E 10
D 2
.B no
E 2
I 2
.Em no
E 2
reverses the effect of that option.  Options are cumulative.
The most useful option is
D 2
.BR all .
E 2
I 2
.Ar all .
.El
.Pp
E 2
Since
D 2
.I \-D
E 2
I 2
.Fl D
E 2
is only used for debugging other options are not documented here:
D 2
the current supported set of options is listed by the \-v option
E 2
I 2
the current supported set of options is listed by the
.Fl v
option
E 2
and a fuller description is available in the program source.
D 2
.SH FILES
.PD 0
.TP 5
.B /a
E 2
I 2
.Sh FILES
.Bl -tag -width /axx
.It Pa /a
E 2
directory under which filesystems are dynamically mounted
D 2
.PD
.SH CAVEATS
E 2
I 2
.El
.Sh CAVEATS
E 2
Some care may be required when creating a mount map.
D 2
.LP
Symbolic links on an NFS filesystem are incredibly inefficient.
Their interpolations are not cached by the kernel and each time a symlink is
E 2
I 2
.Pp
Symbolic links on an
.Tn NFS
D 3
filesystem are incredibly inefficient.
Their interpolations are not cached by the kernel and each time a symbolic
link is
E 3
I 3
filesystem can be incredibly inefficient.
D 5
In most implementations of NFS, their interpolations are not cached by
E 5
I 5
In most implementations of
.Tn NFS ,
their interpolations are not cached by
E 5
the kernel and each time a symbolic link is
E 3
E 2
encountered during a
D 2
.I lookuppn
translation it costs an RPC call to the NFS server.
E 2
I 2
.Em lookuppn
translation it costs an
.Tn RPC
call to the
.Tn NFS
server.
E 2
D 3
It would appear that a large improvement in real-time
E 3
I 3
A large improvement in real-time
E 3
performance could be gained by adding a cache somewhere.
D 2
Replacing symlinks with a suitable incarnation of the auto-mounter
E 2
I 2
Replacing
.Xr symlinks 2
with a suitable incarnation of the auto-mounter
E 2
results in a large real-time speedup, but also causes a large
number of process context switches.
D 2
.LP
E 2
I 2
.Pp
E 2
A weird imagination is most useful to gain full advantage of all
the features.
D 2
.SH "SEE ALSO"
.BR amq (8),
.BR domainname (1),
.BR hostname (1),
.BR automount (8),
.BR mount (8),
.BR umount (8),
.BR mtab (5),
.LP
.I "Amd \- An Automounter"
.SH AUTHOR
Jan-Simon Pendry <jsp@doc.ic.ac.uk>, Department of Computing, Imperial College, London, UK.
E 2
I 2
.Sh SEE ALSO
.Xr amq 8 ,
D 6
.Xr domainname 1 ,
E 6
.Xr hostname 1 ,
D 6
.Xr automount 8 ,
E 6
.Xr mount 8 ,
.Xr umount 8 ,
D 6
.Xr mtab 5 ,
E 6
.Rs
D 3
.%T Amd \- An Automounter
E 3
I 3
.%T Amd \- The 4.4 BSD Automounter
E 3
.Re
.Sh AUTHOR
.An Jan-Simon Pendry
<jsp@doc.ic.ac.uk>, Department of Computing, Imperial College, London, UK.
.Sh HISTORY
D 3
The
.Nm
E 3
I 3
D 5
.Nm Amd
I 4
.\" %sccs.include.redist.man%
E 4
E 3
.At
E 5
I 5
The
D 6
.Nm amd
E 6
I 6
D 9
.Nm Amd
E 6
automounter is
.Ud .
E 9
I 9
.Nm amd
utility first appeared in 4.4BSD.
E 9
E 5
E 2
E 1
