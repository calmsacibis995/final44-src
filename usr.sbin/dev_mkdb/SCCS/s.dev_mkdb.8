h48605
s 00002/00002/00053
d D 8.1 93/06/06 13:55:58 bostic 6 5
c 4.4BSD snapshot (revision 8.1); add 1993 to copyright
e
s 00015/00007/00040
d D 5.5 93/06/02 19:07:04 bostic 5 4
c document the key structure, minor cleanups
e
s 00040/00020/00007
d D 5.4 91/08/05 06:42:22 cael 4 3
c mdoc version three
e
s 00002/00011/00025
d D 5.3 91/05/06 18:04:46 bostic 3 2
c don't describe the format in the man page, so nobody depends on it
e
s 00008/00006/00028
d D 5.2 91/05/02 11:51:40 marc 2 1
c enter block special as well
e
s 00034/00000/00000
d D 5.1 91/02/12 22:00:41 bostic 1 0
c date and time created 91/02/12 22:00:41 by bostic
e
u
U
t
T
I 1
D 6
.\" Copyright (c) 1990 The Regents of the University of California.
.\" All rights reserved.
E 6
I 6
.\" Copyright (c) 1990, 1993
.\"	The Regents of the University of California.  All rights reserved.
E 6
.\"
D 4
.\" %sccs.include.redist.man%
E 4
I 4
.\" %sccs.include.redist.roff%
E 4
.\"
.\"	%W% (Berkeley) %G%
.\"
D 4
.TH dev_mkdb 8 "%Q%"
.UC 7
.SH NAME
dev_mkdb \- create /dev database
.SH SYNOPSIS
.B dev_mkdb
.SH DESCRIPTION
.I Dev_mkdb
creates a
.IR db (3)
database in ``/var/run/dev.db'' which lists the name and
.I st_rdev
D 2
field of all of the character special files in the ``/dev'' directory.
Each of these files is entered, with the
E 2
I 2
D 3
field of all of the character and block special files in the ``/dev'' directory.
Character special files are entered using the
E 2
.I st_rdev
D 2
field as the key and the file name as the data.
E 2
I 2
field as the key.  Block special files are entered using the
.I st_rdev
field followed by a single NULL byte as the key.
The file name is stored as the data.
E 2
.PP
D 2
This database is used by 
E 2
I 2
This database is used by the devname() function in
E 2
.IR ps (1)
D 2
and
.IR ttyname (3).
E 2
I 2
and is shared among several other programs.
E 3
I 3
field of all of the character and block special files in the ``/dev''
E 4
I 4
.Dd %Q%
.Os
.Dt DEV_MKDB 8
.Sh NAME
.Nm dev_mkdb
.Nd create
.Pa /dev
database
.Sh SYNOPSIS
.Nm dev_mkdb
.Sh DESCRIPTION
The
.Nm dev_mkdb
command creates a
.Xr db 3
D 5
database in
E 5
I 5
hash access method database in
E 5
.Dq Pa /var/run/dev.db
D 5
which lists the name and
.Fa st_rdev
field of all of the character and block special files in the
E 5
I 5
which contains the names of all of the character and block special
files in the
E 5
.Dq Pa /dev
E 4
D 5
directory.
E 5
I 5
directory, using the file type and the 
.Fa st_rdev
field as the key.
.Pp
Keys are a structure containing a mode_t followed by a dev_t,
with any padding zero'd out.
The former is the type of the file (st_mode & S_IFMT),
the latter is the st_rdev field.
E 5
E 3
E 2
D 4
.SH FILES
/dev					Device directory
.br
/var/run/dev.db		Database file
.SH SEE ALSO
ps(1), db(3), kvm_nlist(3), ttyname(3), kvm_mkdb(8)
E 4
I 4
.Sh FILES
.Bl -tag -width /var/run/dev.db -compact
.It Pa /dev
Device directory.
.It Pa /var/run/dev.db
Database file.
.El
.Sh SEE ALSO
.Xr ps 1 ,
I 5
.Xr stat 2 ,
E 5
.Xr db 3 ,
I 5
.Xr devname 3 ,
E 5
.Xr kvm_nlist 3 ,
.Xr ttyname 3 ,
.Xr kvm_mkdb 8
.Sh HISTORY
The
.Nm dev_mkdb
D 5
command is
.Ud .
E 5
I 5
command appeared in
.Bx 4.4 .
E 5
E 4
E 1
